window.addEventListener("scroll",function(){const e=document.querySelector(".navbar");window.scrollY>100?(e.style.background="rgba(255, 255, 255, 0.98)",e.style.boxShadow="0 2px 20px rgba(0, 0, 0, 0.1)"):(e.style.background="rgba(255, 255, 255, 0.95)",e.style.boxShadow="none")});const navToggle=document.querySelector(".nav-toggle"),navMenu=document.querySelector(".nav-menu");navToggle.addEventListener("click",function(){navMenu.classList.toggle("active"),navToggle.classList.toggle("active")});function scrollToGenerator(){document.getElementById("generator").scrollIntoView({behavior:"smooth"})}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();const n=document.querySelector(this.getAttribute("href"));n&&n.scrollIntoView({behavior:"smooth",block:"start"})})});const API_CONFIG={baseURL:"https://breakout.wenwen-ai.com/v1/chat/completions",apiKey:"sk-6ogS4COJPVLfLclruLQ6h59IxyvcN61nGuvgpr71VNL3ARsN"};async function generatePaper(){const e=document.querySelector(".generate-btn"),t=document.getElementById("output-content"),n=document.getElementById("research-topic").value,o=document.getElementById("paper-type").value,r=document.getElementById("research-field").value,a=document.getElementById("requirements").value;if(!n.trim())return void alert("Please enter a research topic");e.innerHTML='<i class="fas fa-spinner fa-spin"></i> Generating...',e.disabled=!0;try{const c=buildPrompt(n,o,r,a),s=await fetch(API_CONFIG.baseURL,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${API_CONFIG.apiKey}`},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"system",content:"You are a professional academic writing assistant, skilled at generating high-quality academic content."},{role:"user",content:c}],max_tokens:4e3,temperature:.7})});if(!s.ok)throw new Error(`API request failed: ${s.status}`);const i=await s.json();t.innerHTML=formatGeneratedContent(i.choices[0].message.content,n,o,r)}catch(l){console.error("Error generating paper:",l),t.innerHTML=generateMockContent(n,o,r,a),showNotification("API call failed, showing example content")}finally{e.innerHTML='<i class="fas fa-magic"></i> Generate Paper',e.disabled=!1}}function buildPrompt(e,t,n,o){const r={phd:"PhD Dissertation",master:"Master's Thesis",proposal:"Research Proposal",review:"Literature Review"};let a=`Please generate detailed outline and content for the following research topic:\n\nResearch Topic: ${e}\nResearch Field: ${n}\nPaper Type: ${r[t]||t}`;return o&&(a+=`\nSpecial Requirements: ${o}`),a+="\n\nPlease generate content according to the following structure:\n1. Research Background and Significance\n2. Literature Review\n3. Research Methodology\n4. Expected Results\n5. Innovation Points\n6. Reference Suggestions\n\nPlease ensure the content is professional, detailed, and academically valuable.",a}function formatGeneratedContent(e,t,n,o){const r={phd:"PhD Dissertation",master:"Master's Thesis",proposal:"Research Proposal",review:"Literature Review"};return`\n        <div class="generated-content">\n            <h3>${r[n]||"Academic Paper"}: ${t}</h3>\n            <div class="content-body">\n                ${e.replace(/\n/g,"<br>")}\n            </div>\n            <div class="content-meta">\n                <small>\n                    <i class="fas fa-clock"></i> \n                    Generated: ${new Date().toLocaleString()} |\n                    Field: ${o} |\n                    Type: ${r[n]||n}\n                </small>\n            </div>\n        </div>\n    `}function generateMockContent(e,t,n,o){const r={phd:"PhD Dissertation",master:"Master's Thesis",proposal:"Research Proposal",review:"Literature Review"},a={education:"Education",psychology:"Psychology","computer-science":"Computer Science",medicine:"Medicine",engineering:"Engineering",business:"Business",other:"Other"};return`\n        <div class="generated-content">\n            <h3>${r[t]} Outline</h3>\n            <h4>Research Topic: ${e}</h4>\n            <p><strong>Research Field:</strong> ${a[n]}</p>\n            \n            <div class="content-body">\n                <h5>1. Introduction</h5>\n                <p>This research aims to explore issues related to ${e}. With the rapid development in the field of ${a[n]}, this research has important theoretical value and practical significance.</p>\n                \n                <h5>2. Literature Review</h5>\n                <p>Through systematic review of relevant literature, current research has gaps in the following areas:</p>\n                <ul>\n                    <li>Theoretical framework needs further improvement</li>\n                    <li>Empirical research is relatively lacking</li>\n                    <li>Research methods need innovation</li>\n                </ul>\n                \n                <h5>3. Research Methodology</h5>\n                <p>This research adopts mixed research methods, combining quantitative and qualitative analysis:</p>\n                <ul>\n                    <li>Survey method: Collect large sample data</li>\n                    <li>In-depth interview method: Obtain deep insights</li>\n                    <li>Case study method: Provide specific examples</li>\n                </ul>\n                \n                <h5>4. Expected Results</h5>\n                <p>This research is expected to achieve breakthroughs in the following areas:</p>\n                <ul>\n                    <li>Construct new theoretical models</li>\n                    <li>Propose practical guidance suggestions</li>\n                    <li>Lay foundation for subsequent research</li>\n                </ul>\n                \n                <h5>5. Research Significance</h5>\n                <p>The theoretical significance of this research lies in enriching the theoretical system of ${a[n]}, and the practical significance lies in providing scientific basis for the development of related fields.</p>\n            </div>\n            \n            <p><small><i class="fas fa-info-circle"></i> This is AI-generated sample content. In actual use, more detailed and professional content will be generated according to your specific needs.</small></p>\n        </div>\n    `}async function copyToClipboard(){try{const e=document.getElementById("output-content").innerText;await navigator.clipboard.writeText(e),showNotification("Content copied to clipboard")}catch(t){console.error("Copy failed: ",t)}}function showNotification(e,t="info"){const n=document.createElement("div");n.className=`notification ${t}`,n.innerHTML=`\n        <i class="fas fa-${"success"===t?"check-circle":"error"===t?"exclamation-circle":"info-circle"}"></i>\n        ${e}\n    `,n.style.cssText="\n        position: fixed;\n        top: 20px;\n        right: 20px;\n        background: #10b981;\n        color: white;\n        padding: 1rem 1.5rem;\n        border-radius: 10px;\n        z-index: 10000;\n        animation: slideIn 0.3s ease;\n    ",document.body.appendChild(n),setTimeout(()=>{n.remove()},3e3)}const style=document.createElement("style");style.textContent="\n    @keyframes slideIn {\n        from {\n            transform: translateX(100%);\n            opacity: 0;\n        }\n        to {\n            transform: translateX(0);\n            opacity: 1;\n        }\n    }\n\n    .generated-paper {\n        text-align: left;\n        line-height: 1.6;\n    }\n\n    .generated-paper h3 {\n        color: #1e293b;\n        margin-bottom: 1rem;\n        font-size: 1.3rem;\n    }\n\n    .generated-paper h4 {\n        color: #374151;\n        margin-bottom: 0.5rem;\n        font-size: 1.1rem;\n    }\n\n    .generated-paper h5 {\n        color: #4b5563;\n        margin: 1.5rem 0 0.5rem 0;\n        font-size: 1rem;\n    }\n\n    .paper-section {\n        margin-bottom: 1.5rem;\n        padding-bottom: 1rem;\n        border-bottom: 1px solid #e5e7eb;\n    }\n\n    .paper-section:last-of-type {\n        border-bottom: none;\n    }\n\n    .paper-section ul {\n        margin: 0.5rem 0;\n        padding-left: 1.5rem;\n    }\n\n    .paper-section li {\n        margin-bottom: 0.3rem;\n        color: #6b7280;\n    }\n\n    .generation-info {\n        background: #f3f4f6;\n        padding: 1rem;\n        border-radius: 8px;\n        margin-top: 1.5rem;\n    }\n\n    .generation-info small {\n        color: #6b7280;\n    }\n\n    .nav-menu.active {\n        display: flex;\n        position: absolute;\n        top: 100%;\n        left: 0;\n        right: 0;\n        background: white;\n        flex-direction: column;\n        padding: 1rem;\n        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);\n    }\n\n    .nav-toggle.active span:nth-child(1) {\n        transform: rotate(-45deg) translate(-5px, 6px);\n    }\n\n    .nav-toggle.active span:nth-child(2) {\n        opacity: 0;\n    }\n\n    .nav-toggle.active span:nth-child(3) {\n        transform: rotate(45deg) translate(-5px, -6px);\n    }\n\n    @media (max-width: 768px) {\n        .nav-menu {\n            display: none;\n        }\n    }\n",document.head.appendChild(style);const highlightStyle=document.createElement("style");highlightStyle.textContent="\n    @keyframes highlight {\n        0% { background-color: transparent; }\n        50% { background-color: rgba(102, 126, 234, 0.1); }\n        100% { background-color: transparent; }\n    }\n",document.head.appendChild(highlightStyle),document.addEventListener("click",function(e){if(e.target.closest(".tool-card-link")||e.target.closest(".nav-link")||e.target.closest("nav a"))return;if(e.target.closest(".action-btn")){const t=e.target.closest(".action-btn"),n=t.querySelector("i"),o=document.getElementById("output-content");if(n.classList.contains("fa-copy")){const r=o.textContent;r&&!r.includes("Your generated academic content will be displayed here")?copyToClipboard(r):showNotification("No content to copy")}else n.classList.contains("fa-download")?downloadContent():n.classList.contains("fa-share")&&shareContent()}});function downloadContent(){const e=document.getElementById("output-content"),t=e.textContent;if(t&&!t.includes("Your generated academic content will be displayed here")){const n=new Blob([t],{type:"text/plain"}),o=URL.createObjectURL(n),r=document.createElement("a");r.href=o,r.download="ai-generated-paper.txt",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(o),showNotification("File download started")}else showNotification("No content to download")}function shareContent(){navigator.share?navigator.share({title:"AI Generated Academic Content",text:"Content generated by AI Academic Writing Assistant",url:window.location.href}):(copyToClipboard(window.location.href),showNotification("Link copied to clipboard"))}document.addEventListener("DOMContentLoaded",function(){console.log("DOM loaded, initializing..."),initTooltips();const e=document.querySelectorAll("[onclick]");console.log("Found buttons with onclick:",e.length),e.forEach((t,n)=>{console.log(`Button ${n+1}:`,t.onclick),t.addEventListener("click",function(o){console.log("Button clicked:",t),t.onclick&&t.onclick.call(t,o)})}),console.log("Tool card links will use native browser navigation"),console.log("navigateToPage function exists:",typeof navigateToPage),window.testNavigation=function(){navigateToPage("phd-assistant.html")},console.log("Navigation setup complete. You can test with: testNavigation()");const n=document.querySelectorAll(".tool-btn");console.log("Found",n.length,"tool buttons"),n.forEach((e,t)=>{console.log(`Button ${t+1}:`,e.onclick)}),console.log("openTool function exists:",typeof openTool);const o=document.querySelectorAll(".tool-modal");console.log("Found modals:",o.length),o.forEach((e,t)=>{console.log(`Modal ${t} ID:`,e.id)})});function initTooltips(){document.querySelectorAll("[data-tooltip]").forEach(e=>{e.addEventListener("mouseenter",showTooltip),e.addEventListener("mouseleave",hideTooltip)})}function showTooltip(e){const t=document.createElement("div");t.className="tooltip",t.textContent=e.target.getAttribute("data-tooltip"),t.style.cssText="\n        position: absolute;\n        background: #1f2937;\n        color: white;\n        padding: 0.5rem 1rem;\n        border-radius: 6px;\n        font-size: 0.875rem;\n        z-index: 10000;\n        pointer-events: none;\n        opacity: 0;\n        transition: opacity 0.3s ease;\n    ",document.body.appendChild(t);const n=e.target.getBoundingClientRect();t.style.left=n.left+n.width/2-t.offsetWidth/2+"px",t.style.top=n.top-t.offsetHeight-10+"px",setTimeout(()=>{t.style.opacity="1"},10),e.target._tooltip=t}function hideTooltip(e){e.target._tooltip&&(e.target._tooltip.remove(),delete e.target._tooltip)}function openTool(e){console.log("openTool called with:",e);const t=e+"-modal";console.log("Looking for modal with ID:",t);const n=document.getElementById(t);console.log("Modal element found:",n),n?(console.log("Opening modal..."),n.style.display="flex",document.body.style.overflow="hidden",console.log("Modal opened successfully"),setTimeout(()=>{const e=document.getElementById("generator");e&&e.scrollIntoView({behavior:"smooth"})},300)):(console.error("Modal not found with ID:",t),navigateToTool(e))}function navigateToPage(e){console.log("navigateToPage called with:",e);try{alert("Navigating to: "+e),window.location.href=e,console.log("Navigation initiated to:",e)}catch(t){console.error("Navigation error:",t),alert("Navigation failed: "+t.message)}}function navigateToTool(e){console.log("Navigating to tool:",e),hideAllToolSections();const t=document.getElementById(e+"-section");t&&(t.style.display="block",t.scrollIntoView({behavior:"smooth"}))}function hideAllToolSections(){document.querySelectorAll(".tool-section").forEach(e=>{e.style.display="none"})}function closeTool(){document.querySelectorAll(".tool-modal").forEach(e=>{e.style.display="none"}),document.body.style.overflow="auto"}