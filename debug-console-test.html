<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ§åˆ¶å°è°ƒè¯•æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .console-output {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin-top: 10px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .tool-card-link {
            display: inline-block;
            background: #6366f1;
            color: white;
            text-decoration: none;
            padding: 15px 25px;
            border-radius: 8px;
            margin: 10px;
            transition: all 0.3s ease;
        }
        .tool-card-link:hover {
            background: #4f46e5;
            transform: translateY(-2px);
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .status.success { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
        .status.info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ” ä¸»é¡µJavaScriptè°ƒè¯•æµ‹è¯•</h1>
        
        <div class="test-section">
            <h3>1. JavaScriptåŠ è½½æ£€æµ‹</h3>
            <button class="test-button" onclick="checkScriptLoading()">æ£€æŸ¥Script.jsåŠ è½½çŠ¶æ€</button>
            <div id="script-status" class="console-output"></div>
        </div>

        <div class="test-section">
            <h3>2. å·¥å…·å¡ç‰‡é“¾æ¥æµ‹è¯•</h3>
            <p>æµ‹è¯•å·¥å…·å¡ç‰‡é“¾æ¥ï¼ˆä¸ä¸»é¡µç›¸åŒçš„HTMLç»“æ„ï¼‰ï¼š</p>
            <a href="grant-proposal.html" class="tool-card-link">Grant Proposal Generator</a>
            <a href="dissertation-writer.html" class="tool-card-link">Dissertation Writer</a>
            <a href="research-paper.html" class="tool-card-link">Research Paper AI</a>
            
            <button class="test-button" onclick="testToolCardLinks()">æµ‹è¯•å¡ç‰‡é“¾æ¥åŠŸèƒ½</button>
            <div id="link-test-output" class="console-output"></div>
        </div>

        <div class="test-section">
            <h3>3. æ§åˆ¶å°é”™è¯¯ç›‘æ§</h3>
            <button class="test-button" onclick="startErrorMonitoring()">å¼€å§‹ç›‘æ§æ§åˆ¶å°é”™è¯¯</button>
            <button class="test-button" onclick="clearErrorLog()">æ¸…ç©ºé”™è¯¯æ—¥å¿—</button>
            <div id="error-log" class="console-output"></div>
        </div>

        <div class="test-section">
            <h3>4. ä¸»é¡µé“¾æ¥æµ‹è¯•</h3>
            <button class="test-button" onclick="testMainPageLinks()">æµ‹è¯•ä¸»é¡µé“¾æ¥</button>
            <a href="http://localhost:8000" target="_blank" class="test-button" style="text-decoration: none;">æ‰“å¼€ä¸»é¡µ</a>
            <div id="main-page-test" class="console-output"></div>
        </div>
    </div>

    <script>
        let errorLog = [];
        
        // æ•è·æ‰€æœ‰JavaScripté”™è¯¯
        window.addEventListener('error', function(e) {
            const errorInfo = {
                message: e.message,
                filename: e.filename,
                lineno: e.lineno,
                colno: e.colno,
                error: e.error ? e.error.toString() : 'Unknown error',
                timestamp: new Date().toLocaleTimeString()
            };
            errorLog.push(errorInfo);
            updateErrorDisplay();
        });

        // æ•è·Promise rejectioné”™è¯¯
        window.addEventListener('unhandledrejection', function(e) {
            const errorInfo = {
                message: 'Unhandled Promise Rejection: ' + e.reason,
                timestamp: new Date().toLocaleTimeString()
            };
            errorLog.push(errorInfo);
            updateErrorDisplay();
        });

        function checkScriptLoading() {
            const output = document.getElementById('script-status');
            let status = '';
            
            // æ£€æŸ¥script.jsæ˜¯å¦åŠ è½½
            const scripts = document.querySelectorAll('script[src]');
            status += 'å·²åŠ è½½çš„è„šæœ¬æ–‡ä»¶:\n';
            scripts.forEach(script => {
                status += `- ${script.src}\n`;
            });
            
            // æ£€æŸ¥å…³é”®å‡½æ•°æ˜¯å¦å­˜åœ¨
            status += '\nå…³é”®å‡½æ•°æ£€æŸ¥:\n';
            status += `- navigateToPage: ${typeof navigateToPage !== 'undefined' ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨'}\n`;
            status += `- openTool: ${typeof openTool !== 'undefined' ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨'}\n`;
            
            // æ£€æŸ¥DOMå…ƒç´ 
            status += '\nDOMå…ƒç´ æ£€æŸ¥:\n';
            const toolCardLinks = document.querySelectorAll('.tool-card-link');
            status += `- .tool-card-link å…ƒç´ æ•°é‡: ${toolCardLinks.length}\n`;
            
            output.textContent = status;
        }

        function testToolCardLinks() {
            const output = document.getElementById('link-test-output');
            const links = document.querySelectorAll('.tool-card-link');
            let result = `æ‰¾åˆ° ${links.length} ä¸ªå·¥å…·å¡ç‰‡é“¾æ¥:\n\n`;
            
            links.forEach((link, index) => {
                result += `é“¾æ¥ ${index + 1}:\n`;
                result += `- href: ${link.href}\n`;
                result += `- æ–‡æœ¬: ${link.textContent.trim()}\n`;
                result += `- å¯ç‚¹å‡»: ${link.style.pointerEvents !== 'none' ? 'âœ…' : 'âŒ'}\n\n`;
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨è¿›è¡Œæµ‹è¯•
                link.addEventListener('click', function(e) {
                    console.log('æµ‹è¯•é¡µé¢é“¾æ¥è¢«ç‚¹å‡»:', link.href);
                    result += `âœ… é“¾æ¥ ${index + 1} ç‚¹å‡»äº‹ä»¶è§¦å‘\n`;
                    output.textContent = result;
                });
            });
            
            output.textContent = result;
        }

        function startErrorMonitoring() {
            errorLog = []; // æ¸…ç©ºä¹‹å‰çš„é”™è¯¯
            updateErrorDisplay();
            
            // å°è¯•åŠ è½½ä¸»é¡µçš„script.jsæ¥æ£€æµ‹é”™è¯¯
            const script = document.createElement('script');
            script.src = 'script.js';
            script.onload = function() {
                const output = document.getElementById('error-log');
                output.textContent = 'âœ… script.js åŠ è½½æˆåŠŸï¼Œå¼€å§‹ç›‘æ§é”™è¯¯...\n' + output.textContent;
            };
            script.onerror = function() {
                const errorInfo = {
                    message: 'âŒ script.js åŠ è½½å¤±è´¥',
                    timestamp: new Date().toLocaleTimeString()
                };
                errorLog.push(errorInfo);
                updateErrorDisplay();
            };
            document.head.appendChild(script);
        }

        function clearErrorLog() {
            errorLog = [];
            updateErrorDisplay();
        }

        function updateErrorDisplay() {
            const output = document.getElementById('error-log');
            if (errorLog.length === 0) {
                output.textContent = 'æš‚æ— é”™è¯¯è®°å½•';
                return;
            }
            
            let display = '';
            errorLog.forEach((error, index) => {
                display += `[${error.timestamp}] ${error.message}\n`;
                if (error.filename) {
                    display += `  æ–‡ä»¶: ${error.filename}:${error.lineno}:${error.colno}\n`;
                }
                if (error.error && error.error !== 'Unknown error') {
                    display += `  è¯¦æƒ…: ${error.error}\n`;
                }
                display += '\n';
            });
            
            output.textContent = display;
        }

        function testMainPageLinks() {
            const output = document.getElementById('main-page-test');
            output.textContent = 'æ­£åœ¨æµ‹è¯•ä¸»é¡µé“¾æ¥...\n';
            
            // ä½¿ç”¨fetchæ£€æŸ¥ä¸»é¡µæ˜¯å¦å¯è®¿é—®
            fetch('http://localhost:8000')
                .then(response => {
                    if (response.ok) {
                        output.textContent += 'âœ… ä¸»é¡µæœåŠ¡å™¨å“åº”æ­£å¸¸\n';
                        return response.text();
                    } else {
                        throw new Error(`HTTP ${response.status}`);
                    }
                })
                .then(html => {
                    // æ£€æŸ¥HTMLä¸­æ˜¯å¦åŒ…å«å·¥å…·å¡ç‰‡
                    const hasToolCards = html.includes('tool-card-link');
                    output.textContent += `âœ… ä¸»é¡µHTMLåŠ è½½æˆåŠŸ\n`;
                    output.textContent += `${hasToolCards ? 'âœ…' : 'âŒ'} ä¸»é¡µåŒ…å«å·¥å…·å¡ç‰‡é“¾æ¥\n`;
                    
                    // æ£€æŸ¥æ˜¯å¦å¼•ç”¨äº†script.js
                    const hasScript = html.includes('script.js');
                    output.textContent += `${hasScript ? 'âœ…' : 'âŒ'} ä¸»é¡µå¼•ç”¨äº†script.js\n`;
                })
                .catch(error => {
                    output.textContent += `âŒ ä¸»é¡µè®¿é—®å¤±è´¥: ${error.message}\n`;
                });
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è¿è¡Œä¸€äº›æ£€æŸ¥
        document.addEventListener('DOMContentLoaded', function() {
            console.log('è°ƒè¯•é¡µé¢åŠ è½½å®Œæˆ');
            checkScriptLoading();
        });
    </script>
</body>
</html>